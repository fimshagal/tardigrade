<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Tardigrade sandbox</title>
</head>
<body>
    <script type="module">
        import { createTardigrade } from "./";

        (async () => {
            const resolverKeys = {
                resolverA: "resolverA",
                resolverB: "resolverB",
                resolverC: "resolverC",
            };

            const tardigrade = createTardigrade({
                [resolverKeys.resolverA]: async () => {
                    return new Promise((resolve) => {
                        setTimeout(() => {
                            resolve(`${resolverKeys.resolverA} done`);
                        }, 1000);
                    });
                },
                [resolverKeys.resolverB]: async () => {
                    return new Promise((resolve) => {
                        setTimeout(() => {
                            resolve(`${resolverKeys.resolverB} done`);
                        }, 1000);
                    });
                },
                [resolverKeys.resolverC]: async () => {
                    return new Promise((resolve) => {
                        setTimeout(() => {
                            resolve(`${resolverKeys.resolverC} done`);
                        }, 1000);
                    });
                },
            });

            tardigrade.addResolverListener(resolverKeys.resolverA, value => console.log(value));
            tardigrade.addResolverListener(resolverKeys.resolverB, value => console.log(value));
            tardigrade.addResolverListener(resolverKeys.resolverC, value => console.log(value));

            await tardigrade.callResolversChain(
                resolverKeys.resolverA,
                resolverKeys.resolverB,
                resolverKeys.resolverC
            );

        })();

    </script>
</body>
</html>